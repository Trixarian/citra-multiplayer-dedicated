From e01b6c031549854210d5847d792546417110ef0b Mon Sep 17 00:00:00 2001
From: liushuyu <liushuyu011@gmail.com>
Date: Fri, 20 Aug 2021 05:46:35 -0600
Subject: [PATCH 3/3] Fix web service after core separation

---
 src/network/CMakeLists.txt     | 8 ++++++++
 src/web_service/CMakeLists.txt | 3 ++-
 2 files changed, 10 insertions(+), 1 deletion(-)

diff --git a/src/network/CMakeLists.txt b/src/network/CMakeLists.txt
index 1a9dfe836..f429e2d52 100644
--- a/src/network/CMakeLists.txt
+++ b/src/network/CMakeLists.txt
@@ -17,4 +17,12 @@ add_library(network STATIC
 
 create_target_directory_groups(network)
 
+if (ENABLE_WEB_SERVICE)
+    target_compile_definitions(network PRIVATE -DENABLE_WEB_SERVICE -DCPPHTTPLIB_OPENSSL_SUPPORT)
+    target_link_libraries(network PRIVATE web_service httplib)
+    if (ANDROID)
+        target_link_libraries(network PRIVATE ifaddrs)
+    endif()
+endif()
+
 target_link_libraries(network PRIVATE common enet Boost::serialization)
diff --git a/src/web_service/CMakeLists.txt b/src/web_service/CMakeLists.txt
index b43eae5d1..3b02f592a 100644
--- a/src/web_service/CMakeLists.txt
+++ b/src/web_service/CMakeLists.txt
@@ -14,7 +14,8 @@ add_library(web_service STATIC
 create_target_directory_groups(web_service)
 
 target_compile_definitions(web_service PRIVATE -DCPPHTTPLIB_OPENSSL_SUPPORT)
-target_link_libraries(web_service PRIVATE common network json-headers ${OPENSSL_LIBS} httplib cpp-jwt)
+target_link_libraries(web_service PRIVATE common network json-headers httplib cpp-jwt)
+target_link_libraries(web_service PUBLIC ${OPENSSL_LIBS})
 if (ANDROID)
     target_link_libraries(web_service PRIVATE ifaddrs)
 elseif(WIN32)
-- 
2.36.1

